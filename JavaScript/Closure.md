## 렉시컬 환경

자바스크립트는 렉시컬 환경을 가진다고 합니다.  
코드가 실행되면 스크립트 내에 선언된 변수들은 렉시컬 환경에 올라가게 됩니다.  
  
위의 설명만 보았을 때는 렉시컬 환경이라는 것에 대해 이해가 어려워서 예시로 설명을 하자면 아래와 같습니다.

```javascript
let x = 10;

function test(y){
		alert(x + y);
}

test(5); // 15;
```

처음 위의 코드가 실행되면 **렉시컬 환경**이 생성됩니다.  
그 렉시컬 환경에는 ```x=10```, ```test함수```가 렉시컬 환경에 올라갑니다.  
  
이후에 코드가 한줄 한줄 실행되면서 ```test(5);```를 만났을 때  

**test함수에 대한 새로운 렉시컬 환경**이 생성되게 되고, 이 렉시컬 환경에는 ```y=5```가 올라가게 되면서 **전역 렉시컬 환경을 참조**하는 구조가 만들어지게 됩니다.  
  

## Closure

클로저는 함수와 렉시컬 환경의 조합입니다.  
함수가 생성될 당시의 외부변수를 기억하고 외부함수의 실행이 끝나고 소멸되어도  
내부함수가 외부함수의 변수에 접근 할 수 있습니다.

```javascript
function test(x){
		return function(y){
				return x + y;
		}
}

let run = test1(5);
console.log(run(10));
```

처음 코드가 실행되면 `test함수`, `run(초기화 안됨)`이 렉시컬 환경에 올라가게 됩니다.  
  
이후에 `test(5);`가 실행되면서 **test에 대한 렉시컬 환경**이 생성 되고, `x = 5` 가 올라가게 됩니다.  
  
그리고 `run(10);`이 실행되면 내부 함수인 **익명함수에 대한 렉시컬 환경**이 하나 더 생성되면서 `y = 10`이 올라가게 되고 아래와 같은 구조를 가지게 됩니다.

> **(전역 렉시컬 환경)** `test함수`, `run(초기화 안됨)`이 올라간 렉시컬 환경

⬆️**참조**

> **(test함수 렉시컬 환경)** `x = 5`가 올라간 렉시컬 환경

⬆️**참조**

> **(익명함수 렉시컬 환경)** `y = 10`가 올라간 렉시컬 환경

익명함수부터 시작해서 전역 렉시컬 환경까지 점점 범위를 넓혀가면서 필요한 정보를 찾게 됩니다.  
  
정리하자면 return되는 익명함수(내부함수)는 상위함수(외부함수)의 매개변수 x에 접근이 가능하고, 외부함수가 실행 후 소멸시점인 `run(10);`를 만나게 되어도 x에 접근이 가능해집니다. 이런 경우를 **클로저**라고 합니다.


